<%- include("partials/header") %>

    <section class="account-page">
        <div class="account-container">

            <!-- Sidebar -->
            <div class="account-sidebar">
                <div class="account-profile">
                    <div class="account-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <h3>
                        <%= user.name %>
                    </h3>
                    <p>
                        <%= user.email %>
                    </p>
                </div>
                <nav class="account-nav">
                    <a href="#profile" class="account-nav-link active" data-tab="profile">
                        <i class="fas fa-user"></i> My Profile
                    </a>
                    <a href="#cart" class="account-nav-link" data-tab="cart">
                        <i class="fas fa-shopping-cart"></i> My Cart
                    </a>
                    <a href="#orders" class="account-nav-link" data-tab="orders">
                        <i class="fas fa-box"></i> My Orders
                    </a>
                    <a href="/logout" class="account-nav-link logout-link">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a>
                </nav>
            </div>

            <!-- Main Content -->
            <div class="account-content">

                <!-- Profile Tab -->
                <div class="account-tab active" id="tab-profile">
                    <div class="account-section-header">
                        <h2><i class="fas fa-user"></i> My Profile</h2>
                    </div>
                    <div class="profile-info">
                        <div class="profile-field">
                            <label>Full Name</label>
                            <p>
                                <%= user.name %>
                            </p>
                        </div>
                        <div class="profile-field">
                            <label>Email Address</label>
                            <p>
                                <%= user.email %>
                            </p>
                        </div>
                        <div class="profile-field">
                            <label>Account Status</label>
                            <p><span class="badge-active">Active</span></p>
                        </div>
                    </div>
                </div>

                <!-- Cart Tab -->
                <div class="account-tab" id="tab-cart">
                    <div class="account-section-header">
                        <h2><i class="fas fa-shopping-cart"></i> My Cart</h2>
                    </div>
                    <% if (cartItems.length===0) { %>
                        <div class="account-empty">
                            <i class="fas fa-shopping-cart"></i>
                            <p>Your cart is empty</p>
                            <a href="/products" class="btn btn-primary">Shop Now</a>
                        </div>
                        <% } else { %>
                            <div class="account-cart-list">
                                <% cartItems.forEach(item=> { %>
                                    <div class="account-cart-item">
                                        <img src="<%= item.image %>" alt="<%= item.name %>">
                                        <div class="account-cart-details">
                                            <h4>
                                                <%= item.name %>
                                            </h4>
                                            <p>₹<%= item.price.toLocaleString() %> × <%= item.quantity %>
                                            </p>
                                            <p class="account-cart-total">₹<%= (item.price *
                                                    item.quantity).toLocaleString() %>
                                            </p>
                                        </div>
                                        <form action="/cart/remove/<%= item.id %>" method="POST">
                                            <button type="submit" class="btn-remove"><i
                                                    class="fas fa-trash"></i></button>
                                        </form>
                                    </div>
                                    <% }) %>
                            </div>
                            <a href="/cart" class="btn btn-primary">View Full Cart</a>
                            <% } %>
                </div>

                <!-- Orders Tab -->
                <div class="account-tab" id="tab-orders">
                    <div class="account-section-header">
                        <h2><i class="fas fa-box"></i> My Orders</h2>
                    </div>
                    <% if (orders.length===0) { %>
                        <div class="account-empty">
                            <i class="fas fa-box-open"></i>
                            <p>No orders yet</p>
                            <a href="/products" class="btn btn-primary">Start Shopping</a>
                        </div>
                        <% } else { %>
                            <div class="orders-list">
                                <% orders.forEach(order=> { %>
                                    <div class="order-card">
                                        <div class="order-info">
                                            <h4>Order #<%= order.id %>
                                            </h4>
                                            <p>Date: <%= new Date(order.created_at).toLocaleDateString() %>
                                            </p>
                                            <p>Total: ₹<%= order.total.toLocaleString() %>
                                            </p>
                                        </div>
                                        <span class="order-status status-<%= order.status %>">
                                            <%= order.status %>
                                        </span>
                                    </div>
                                    <% }) %>
                            </div>
                            <% } %>
                </div>

            </div>
        </div>
    </section>

    <script>
        // Tab switching
        document.querySelectorAll('.account-nav-link[data-tab]').forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                const tab = this.dataset.tab;

                document.querySelectorAll('.account-nav-link').forEach(l => l.classList.remove('active'));
                document.querySelectorAll('.account-tab').forEach(t => t.classList.remove('active'));

                this.classList.add('active');
                document.getElementById('tab-' + tab).classList.add('active');
            });
        });
    </script>

    <%- include("partials/footer") %>